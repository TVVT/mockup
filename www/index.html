
<!DOCTYPE html>
<html>
    <head>
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>手机mockup原型制作</title>
        <link href="/favicon.ico" rel="shortcut icon">
        <link rel="stylesheet" type="text/css" href="style/global.css" />
    </head>
    <body>
        <header>
            <h1>mockups for ios mobile<sup>beta</sup></h1>
        </header>
        <div class="main" id="main">
            <input type="button" id="add" value='add a page'>
            <br/>
            <canvas id="canvas"></canvas>
        </div>


        <div class="newPage" id="newPage" >
            <div class="con">
                <h4>new page</h4>
                <div class="dragArea" id="dragArea">
                    <p>drag&drop a image or dbclick here</p>
                    <p>image's width must be 320px</p>
                </div>

                <div class="btns">
                    <input type="button" id="newPageFinish" value="finish"> 
                </div>
            </div>
        </div>
        <footer>&copy;eizia 2012</footer>
    </body>

    <script type="text/javascript">
        var doc = document;
        var _add = doc.getElementById('add');
        var _newPage = doc.getElementById('newPage');
        var _dragArea = doc.getElementById('dragArea');
        var _newPageFinish = doc.getElementById('newPageFinish');
        var _main = doc.getElementById('main');
        var _canvas = doc.getElementById('canvas');
        var Pages = [];

        _add.addEventListener('click',function(){
            _newPage.classList.add('show');
            _newPage.classList.remove('hide');
        });

        _newPageFinish.addEventListener('click',function(){
            _newPage.classList.remove('show');
            _newPage.classList.add('hide');
        });

        resizeCanvas = function(){
            _canvas.width = _main.clientWidth;
            _canvas.height = _main.clientHeight;
        }


        initCanvas = function(){
            resizeCanvas();
        }

        drawFile = function(file){
            var src = window.webkitURL.createObjectURL(file);
            var _img = new Image();
            _img.src = src;
            _img.onload = function(){
                var _w = _img.width;
                if(_w !== 320){
                    alert('please cut your image to 320px;');
                    return false;
                }else{
                    _dragArea.style.border = '';
                    _dragArea.innerHTML = '';
                    _dragArea.style.backgroundImage = 'url(' + src +')';
                }
            }
        };

        _dragArea.addEventListener('dblclick',function(){
            var _input = doc.createElement('input');
            _input.setAttribute('type','file');
            _input.setAttribute('accept','image/*');
            _input.click();
            _input.addEventListener('change',function(e){
                var file = _input.files[0];
                drawFile(file);
            });
        });

        _dragArea.addEventListener('dragenter', function(e) {
            e.preventDefault();
            this.style.border = '1px solid red';
        }, false); 
        _dragArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.style.border = '';
        }, false);
        _dragArea.addEventListener('dragover', function(e) {
            e.preventDefault();
        }, false);
        _dragArea.addEventListener('drop', function(e) {
            e.preventDefault();
            var file = e.dataTransfer.files[0];
            var type = file.type;
            if(type.match('image')){
                drawFile(file);
            }else{
                alert('please drag a image!');
            }
        }, false);



        initCanvas();


    </script>
</html>